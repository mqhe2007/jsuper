!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).jsuper={})}(this,(function(e){"use strict";function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function t(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function i(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return o(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var f,u=!0,a=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return u=e.done,e},e:function(e){a=!0,f=e},f:function(){try{u||null==t.return||t.return()}finally{if(a)throw f}}}}var f=function(){function e(t,r){n(this,e),this.delayTime=t,this.timeoutHandler=r,this.timer=void 0}return r(e,[{key:"listen",value:function(){window.addEventListener("click",this.resetTime),window.addEventListener("keydown",this.resetTime),window.addEventListener("mousemove",this.resetTime),window.addEventListener("mousewheel",this.resetTime)}},{key:"clearListen",value:function(){clearTimeout(this.timer),window.removeEventListener("click",this.resetTime),window.removeEventListener("keydown",this.resetTime),window.removeEventListener("mousemove",this.resetTime),window.removeEventListener("mousewheel",this.resetTime)}},{key:"resetTime",value:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout((function(){e.timeoutHandler(),e.clearListen(),e.timer=void 0}),1e3*this.delayTime)}}]),e}();var u=function(){function e(){n(this,e),this.events={}}return r(e,[{key:"emit",value:function(e,n){if(!this.events[e])return console.warn("".concat(e,"事件触发了，但是没有监听者，什么都不会发生。"));var t,r=i(this.events[e].values());try{for(r.s();!(t=r.n()).done;){(0,t.value)(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"on",value:function(e,n){"function"==typeof n&&(this.events[e]||(this.events[e]=new Set),this.events[e].add(n))}},{key:"off",value:function(e,n){if(!n)return console.warn("取消监听必须传入已被监听的事件处理函数");this.events[e].delete(n)}},{key:"clear",value:function(){this.events={}}},{key:"getEvents",value:function(){return this.events}}]),e}(),a=function(e,n){if("function"!=typeof n)return console.error("".concat(e,"事件的处理程序不是函数。"));var t=Symbol.for("___JSUPER_EVENT_BUS___");window[t].has(e)||window[t].set(e,new Set),window[t].get(e).add(n)},s=function(e,n){if(!window[r].has(e))return console.warn("".concat(e,"事件触发了，但是没有监听者，什么都不会发生。"));var t,r=Symbol.for("___JSUPER_EVENT_BUS___"),o=i(window[r].get(e).values());try{for(o.s();!(t=o.n()).done;){(0,t.value)(n)}}catch(e){o.e(e)}finally{o.f()}},c=function(e,n){if(!n)return console.error("取消监听必须传入已被监听的事件处理函数");var t=Symbol.for("___JSUPER_EVENT_BUS___");window[t].has(e)&&window[t].get(e).delete(n)},l=function(){var e=Symbol.for("___JSUPER_EVENT_BUS___");window[e].clear()},d=function(){var e=Symbol.for("___JSUPER_EVENT_BUS___");return window[e]};e.EventBus=u,e.NoActionListener=f,e.findNodeFromTree=function e(n,t,r,o){for(var i=0;i<t.length;i++){var f=t[i];if(f[n[0]]===n[1])return r&&o?(f.parent=o,f):f;if(f.children&&f.children.length>0){o&&(f.parent=o);var u=e(n,f.children,r,f);if(u)return u}}},e.flatToTree=function(e,n,t){var r=[];return e.forEach((function(o){o[t]?r.push(function r(o){var i=e.findIndex((function(e){return e[n]===o[t]}));if(i>-1){var f=e.splice(i,1)[0];return f.children=[],f.children.push(o),f[t]?r(f):f}return o}(o)):r.push(o)})),r},e.platform=function(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("micromessenger")?"wechat":-1!==e.indexOf("iphone")||-1!==e.indexOf("ipad")?"ios":-1!==e.indexOf("android")?"android":"desktop"},e.position=function(e){return{top:function(e){for(var n=e.offsetTop,t=e.offsetParent;null!==t;)n+=t.offsetTop,t=t.offsetParent;return n}(e),left:function(e){for(var n=e.offsetLeft,t=e.offsetParent;null!==t;)n+=t.offsetLeft,t=t.offsetParent;return n}(e)}},e.treeEach=function e(n,t,r){n.forEach((function(n){var o;t(n,r),(null===(o=n.children)||void 0===o?void 0:o.length)&&e(n.children,t,n)}))},e.treeFilter=function e(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return n.filter((function(n){var o=t(n,r);return o&&n.children&&n.children.length>0&&(n.children=e(n.children,t,r+1)),o}))},e.treeMap=function e(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"children",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4?arguments[4]:void 0;return n.map((function(n){var f=t(n,o,i);return n[r]&&n[r].length>0&&(f.children=e(n[r],t,r,o+1,f)),f}))},e.useEventBus=function(){var e=Symbol.for("___JSUPER_EVENT_BUS___");return window[e]||(window[e]=new Map),{emit:s,on:a,off:c,clear:l,getEvents:d}},e.uuid=function(){var e=(new Date).getTime();return window.performance&&"function"==typeof window.performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxx".replace(/[xy]/g,(function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==n?t:3&t|8).toString(16)}))},Object.defineProperty(e,"__esModule",{value:!0})}));
